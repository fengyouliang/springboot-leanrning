# Change Proposal: 全模块文档书籍化重写（Stage 2：主线时间线重排）

## Requirement Background

当前仓库的文档体系已经具备：

- 多模块 `docs/` 的聚合站点（MkDocs）
- 章节末尾稳定的 BOOKIFY 导航与可运行入口（Lab/Test）
- 章节写作形态已完成“去契约化第一层迁移”（不再使用 A–G 字母骨架）

但要达到“像书籍一样顺读”的体验，还缺少第二层的核心：**按主线时间线重排与重写**。

本变更希望把“机制/源码/实验/排障”从并列段落，迁移为叙事中的插入段（提示框/侧栏/穿插段），并通过合并/拆章/重排让章节之间自然承接。

## Change Content

1. 为每个模块建立“主线时间线（Mainline Timeline）”章节：把 Part 的承接、关键分支、读者应该形成的心智模型串成一条线。
2. 重写并重排各模块 `docs/README.md`：把目录从“章节列表”升级为“书籍目录”（顺读主线 + 深挖索引 + 排障入口）。
3. 对核心主线章节进行合并/拆章与叙事润色：让每章成为一段连续叙事，必要处插入源码锚点/实验入口/排障提示。
4. 保持可复现与可定位：不削弱现有 Labs/Tests 与源码断点入口，保留 BOOKIFY 尾部导航与站点严格构建能力。

## Impact Scope

- **Modules:** 全部包含 `docs/README.md` 的模块（`spring-core-*` + `springboot-*`），以及聚合站点 `docs-site` 与相关脚本
- **Files:** 大量 `*/docs/**/*.md`（逐模块分批推进），少量站点配置/脚本文件
- **APIs:** 无
- **Data:** 无

## Core Scenarios

### Requirement: 书籍式顺读体验（全模块）
**Module:** all
读者从每个模块的 `docs/README.md` 出发，可以按“主线时间线”顺读，不被“资料清单化结构”打断。

#### Scenario: 新读者顺读主线（不迷路）
在不了解模块背景的情况下：
- 能从 `README` 找到“从哪章开始读”
- 能理解“为什么下一章在这里”（承接关系明确）

### Requirement: 主线时间线章节（每模块）
**Module:** each module with docs
每个模块至少有 1 篇“时间线章节”，把该模块的机制主线串联起来。

#### Scenario: 时间线章节可作为主线索引
- 能回答：这一模块的主线步骤是什么、关键分支在哪里、对应的实验入口在哪里

### Requirement: 合并/拆章与叙事重写（分批）
**Module:** all (phased)
对主线章节进行重排与润色：机制/源码/实验/排障作为叙事插入段，而不是固定并列段。

#### Scenario: 阅读体验像书而不是模板
- 章节结构自然：导读 → 主线叙事 → 小结/承接
- 实验入口/源码锚点/排障提示通过提示框出现（不打断主线）

### Requirement: 质量闸门不下降
**Module:** docs-site / scripts
每一批改动都必须能通过现有自检与站点构建。

#### Scenario: CI/本地校验稳定
- `bash scripts/check-docs.sh` 通过
- `bash scripts/docs-site-build.sh`（strict）通过

## Risk Assessment

- **Risk:** 大规模合并/拆章/重排可能导致链接断裂、读者书签失效、维护成本激增
  - **Mitigation:** 分批推进；优先“新增主线时间线章节 + 目录重排”；涉及移动/合并时保留旧文件作为 redirect（旧入口不消失）
- **Risk:** 目录重排/命名风格不统一导致“像书”但不好检索
  - **Mitigation:** 统一“时间线章节”命名与写作规范（集中在一份写作指南里），并保持 `docs-site` 侧边栏可展开的细目录
- **Risk:** 长期演进中出现“主线叙事”与“深挖章节”重复
  - **Mitigation:** 主线章节只保留必要叙事与关键决策点；细节统一下沉到深挖章节并以链接引用

